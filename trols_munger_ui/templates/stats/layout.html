{% macro display_stats(games_played, games_won, games_lost, score_for, score_against, ranking_url) -%}
<tr>
  <td><strong>Sets played:</strong></td>
  <td>{{ games_played }}</td>
</tr>
<tr>
  <td><strong>Sets won/lost:</strong></td>
  <td>
    {% set set_pc = 0 %}
    {% if games_lost > 0 %}
      {% set set_pc = games_won / games_lost * 100 %}
    {% endif %}
    {{ games_won }}/{{ games_lost }} @ {{ '%0.2f' % set_pc }}%
  </td>
</tr>
<tr>
  <td><strong>Games won/lost:</strong></td>
  <td>
    {% set score_pc = 0 %}
    {% if score_against > 0 %}
      {% set score_pc = score_for / score_against * 100 %}
    {% endif %}
    {{ score_for }}/{{ score_against }} @ {{ '%0.2f' % score_pc }}%
    <span class="pull-right">
      <a href="{{ ranking_url }}">
        <img alt="Rankings" src="{{ url_for('static', filename='images/ranking.png') }}" width="90%">
      </a>
    </span>
  </td>
</tr>
{%- endmacro %}

{% extends "layout.html" %}
{% block content %}
<div class="panel panel-default">
  <!-- Default panel contents -->
  {% for token, stats in result.iteritems() %}
  <div class="panel-heading">
    <b><i>Statistics for player: </i></b>
    <a href="/munger/players?q={{ stats['name'] | replace(' ', '+') }}">
      {{ stats['name'] }}
    </a> {{ stats['team'] }} Section {{ stats['section'] }} {{ stats['comp_type'] }}
  </div>

  <div class="panel-body">
    <table class="table" style="margin-bottom: 0px;">
      <tbody>
        <tr>
          <td class="col-xs-6">
            <!-- Singles panel -->
            <div class="panel panel-info" style="padding: 0px;">
              <div class="panel-heading">
                <strong>Singles</strong>
              </div>
  
              <div class="panel-body" style="font-size: small; padding: 0px">
                <table class="table" style="margin-bottom: 0px;">
                  <tbody>
                    {% set ranking_url = url_for('munger',
                                                 event='singles',
                                                 type=stats['comp_type'],
                                                 section=stats['section'],
                                                 _anchor=stats['name']) -%}
                    {{ display_stats(stats.singles['games_played'],
                                     stats.singles['games_won'],
                                     stats.singles['games_lost'],
                                     stats.singles['score_for'],
                                     stats.singles['score_against'],
                                     ranking_url) }}
                  </tbody>
                </table>
              </div>
            </div> 
          </td>

          <td class="col-xs-6">
            <!-- Singles panel -->
            <div class="panel panel-info" style="padding: 0px;">
              <div class="panel-heading">
                <strong>Doubles</strong>
              </div>
  
              <div class="panel-body" style="font-size: small; padding: 0px">
                <table class="table" style="margin-bottom: 0px;">
                  <tbody>
                    {% set ranking_url = url_for('munger',
                                                 event='doubles',
                                                 type=stats['comp_type'],
                                                 section=stats['section'],
                                                 _anchor=stats['name']) -%}
                    {{ display_stats(stats.doubles['games_played'],
                                     stats.doubles['games_won'],
                                     stats.doubles['games_lost'],
                                     stats.doubles['score_for'],
                                     stats.doubles['score_against'],
                                     ranking_url) }}
                  </tbody>
                </table>
              </div>
            </div> 
          </td>
        </tr>
      </tbody>
    </table>
  </div>
  {% endfor %}
</div>
{% endblock content %}
